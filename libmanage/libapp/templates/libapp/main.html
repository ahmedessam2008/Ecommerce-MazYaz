<!DOCTYPE html>
{% load static %}
<html lang="ar en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />

    <title>Lib</title>
    <link
      rel="stylesheet"
      href="{% static 'plugins/fontawesome-free/css/all.min.css' %}"
    />

    <!-- Font Awesome Icons -->
    <link
      rel="stylesheet"
      href="{% static 'plugins/jquery_datepacker/jquery_ui.css' %}"
    />
    <!-- IonIcons -->
    <link
      rel="stylesheet"
      href="http://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css"
    />
    <!-- Theme style -->
    <link rel="stylesheet" href="{% static 'dist/css/adminlte_ar.min.css' %}" />
    <!-- Google Font: Source Sans Pro -->
    <link
      href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700"
      rel="stylesheet"
    />
  </head>
  <body dir="rtl" class="hold-transition sidebar-mini">
    <!-- Navbar -->
    <nav class="main-header navbar navbar-expand navbar-white navbar-light">
      <!-- Left navbar links -->
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" data-widget="pushmenu" href="#"
            ><i class="fas fa-bars"></i
          ></a>
        </li>
        <li class="nav-item d-none d-sm-inline-block">
          <a href="{% url 'index' %}" class="nav-link">Home</a>
        </li>
      </ul>

      <!-- SEARCH FORM -->
      <form method="GET" action={% url 'books' %} class="form-inline ml-3">
        <div class="input-group input-group-sm">
          <input
            class="form-control form-control-navbar"
            name="search_name"
            type="search"
            placeholder="Search"
            aria-label="Search"
          />
          <div class="input-group-append">
            <button class="btn btn-navbar" type="submit">
              <i class="fas fa-search"></i>
            </button>
          </div>
        </div>
      </form>
    </nav>
    <!-- Main Sidebar Container -->
    <aside
      style="position: fixed"
      class="main-sidebar sidebar-dark-primary elevation-4"
    >
      <!-- Brand Logo -->
      <a href="{% url 'index' %}" class="brand-link">
        <span class="brand-text font-weight-light">MazYaz</span>
      </a>

      <!-- Sidebar -->
      <div class="sidebar">
        <!-- Sidebar user panel (optional) -->
        <div class="user-panel mt-3 pb-3 mb-3 d-flex">
          <div class="image"></div>
          <div class="info">
            <a href="{% url 'index' %}" class="d-block">Ahmed Essam</a>
          </div>
        </div>

        <!-- Sidebar Menu -->
        <nav class="mt-2">
          <ul
            class="nav nav-pills nav-sidebar flex-column"
            data-widget="treeview"
            role="menu"
            data-accordion="false"
          >
            <li class="nav-item">
              <a href="{% url 'books' %}" class="nav-link">
                <i class="nav-icon fas fa-th"></i>
                <p>New Books</p>
              </a>
            </li>
            <li class="nav-item has-treeview">
              <a href="#" class="nav-link">
                <i class="nav-icon fas fa-copy"></i>
                <p>
                  Category
                  <i class="fas fa-angle-left right"></i>
                </p>
              </a>
              <ul class="nav nav-treeview">
                <li class="nav-item">
                  <a id="addcat" href="#" class="nav-link">
                    <i class="fa fa-plus"></i>
                    <p class="text-light">Add New</p>
                  </a>
                </li>
                <form id="cat" method="POST">
                  {% csrf_token %}
                  <div id="formcat">{{ catform }}</div>

                  <button type="submit" class="btn btn-success">save</button>
                  <button id="backcat" class="btn btn-primary">back</button>
                </form>
                {% for cat in catigory %}
                <li style="cursor: pointer" class="nav-item cat{{cat.id}}">
                  <a id="" class="nav-link">
                    <i class="far fa-circle nav-icon"></i>
                    <p>{{ cat.name }}</p>
                  </a>
                </li>
                {% endfor %}
              </ul>
            </li>

            <li class="nav-header">Book Status</li>

            <li style="cursor: pointer" class="nav-item statussolid">
              <a id="statusSold" class="nav-link">
                <i class="nav-icon far fa-circle text-danger"></i>
                <p class="text">Solid</p>
              </a>
            </li>
            <li style="cursor: pointer" class="nav-item statusrental">
              <a id="" class="nav-link">
                <i class="nav-icon far fa-circle text-warning"></i>
                <p>Rental</p>
              </a>
            </li>
            <li style="cursor: pointer" class="nav-item statusavailable">
              <a id="" class="nav-link">
                <i class="nav-icon far fa-circle text-info"></i>
                <p>Available</p>
              </a>
            </li>
          </ul>
        </nav>
        <!-- /.sidebar-menu -->
      </div>
      <!-- /.sidebar -->
    </aside>
    <!-- Start Content -->
    <div style="direction: rtl" class="wrapper">
      <!-- /.container-fluid -->
      {% block content%} {% endblock content%}
    </div>
    <!-- Main Footer -->
    <footer class="main-footer">
      <strong
        >Copyright &copy; 2020-2021
        <a href="https://www.facebook.com/abdelrahman.g.nofal">Ahmed Essam</a
        >.</strong
      >
      All rights reserved.
      <div class="float-right d-none d-sm-inline-block">
        <a
          target="_blank"
          class="text-danger"
          href="https://www.youtube.com/channel/UCbQh1yxBPVhyjB-G_blFFEQ"
          ><i class="fab fa-lg fa-youtube"></i
        ></a>
        <a target="_blank" href="https://www.facebook.com/abdelrahman.g.nofal"
          ><i class="fab fa-lg ml-1 fa-facebook"></i
        ></a>
        <a
          target="_blank"
          class="text-warning"
          href="https://www.instagram.com/abdelrahman_noufal/"
          ><i class="fab fa-lg ml-1 fa-instagram"></i
        ></a>
      </div>
    </footer>

    <!-- REQUIRED SCRIPTS -->
    <script src="{% static 'plugins/jquery_datepacker/jquery-ui.js' %}"></script>

    <!-- jQuery -->
    <script src="{% static 'plugins/jquery/jquery.min.js' %}"></script>
    <!-- Bootstrap -->
    <script src="{% static 'plugins/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
    <!-- AdminLTE -->
    <script src="{% static 'dist/js/adminlte.js' %}"></script>
    <!-- OPTIONAL SCRIPTS -->

    <script src="{% static 'plugins/chart.js/Chart.min.js' %}"></script>

    <script src="{% static 'dist/js/demo.js' %}"></script>
    <!--<script src="{% static 'dist/js/pages/dashboard3.js' %}"></script>-->
    <script>
      $(document).ready(function () {
        $("#myModal").on("shown.bs.modal", function () {
          $("#myInput").trigger("focus");
        });
        /*here i will make loop for get id category and status for contact with books */
        /*حساب اجمالي الارباح و هي عبارة عن حاصل جمع سعر الكتب عند البيع بالاضافة الى سعر استعارة الكتاب*/
      });
    </script>
    <!-- Start My Scripts -->
    <script>
      	// For Total Salary + Rental
      	$('document').ready(function(){
      		var total = 0;
      		$('.totalprice').each(function(){
      			$(this).hide()
      			var salary = $(this).text()
      			total += parseInt(salary)
      		});
      		$('#totalsalarys').text($('#totalsalarys').text() + total)
      	});
      // Rental Books in Chart
      	var total1 = 0;
      	$('.totalrental').each(function(){
      		$(this).hide()
      		var salary1 = $(this).text()
      		total1 += parseInt(salary1)
      	});
      	$('.salaryrental').text(total1)
      	$('.salaryrental').hide()

      	// Solid Books in Chart
      	var total2 = 0;
      	$('.totalsolid').each(function(){
      		$(this).hide()
      		var salary2 = $(this).text()
      		total2 += parseInt(salary2)
      	});
      	$('.salarysolid').text(total2)
      	$('.salarysolid').hide()

      	// For Calculate Rental Price A * B = Total in keyup in add book Form
      var rentalprice = $("#rentalprice")
      var rentaldays = $('#rentaldays')
      rentaldays.keyup(function(){
      	$('#totlaprice').val(rentalprice.val()*rentaldays.val())
      });

      //  Hide and Show Catigory in Side Bar
      $('#formcat').hide()
      $('#addcat').click(function() {
      	$('#formcat').show()
      });
      $('#backcat').click(function() {
      	$('#formcat').hide()
      });
      	// loop for filtering Books
      	{% for book in books %}

      		$('.cat{{book.catigory.id}}').click(function(){
      			$('.hidebooks').hide()
      			$('.book{{book.catigory.id}}').show()
      		});
      		// For Side Bar
      		$('.status{{book.status}}').click(function(){
      			$('.hidebooks').hide()
      			$('.book{{book.status}}').show()
      		});
      	{% endfor %}
    </script>
    <!-- End My Scripts -->
    <script>
      $(function () {
        "use strict";

        var ticksStyle = {
          fontColor: "#495057",
          fontStyle: "bold",
        };

        var mode = "index";
        var intersect = true;

        var $salesChart = $("#sales-chart");

        var salesChart = new Chart($salesChart, {
          type: "bar",

          data: {
            labels: ["Earnings details"],

            datasets: [
              {
                backgroundColor: "#007bff",
                borderColor: "#007bff",
                data: [$(".salarysolid").text()],
              },
              {
                backgroundColor: "#ced4da",
                borderColor: "#ced4da",
                data: [$(".salaryrental").text()],
              },
            ],
          },

          options: {
            maintainAspectRatio: false,
            tooltips: {
              mode: mode,
              intersect: intersect,
            },
            hover: {
              mode: mode,
              intersect: intersect,
            },
            legend: {
              display: false,
            },
            scales: {
              yAxes: [
                {
                  // display: false,
                  gridLines: {
                    display: true,
                    lineWidth: "4px",
                    color: "rgba(0, 0, 0, .2)",
                    zeroLineColor: "transparent",
                  },
                  ticks: $.extend(
                    {
                      beginAtZero: true,

                      // Include a dollar sign in the ticks
                      callback: function (value, index, values) {
                        if (value >= 1000) {
                          value /= 1000;
                          value += "k";
                        }
                        return "$" + value;
                      },
                    },
                    ticksStyle
                  ),
                },
              ],
              xAxes: [
                {
                  display: true,
                  gridLines: {
                    display: false,
                  },
                  ticks: ticksStyle,
                },
              ],
            },
          },
        });

        var pieChart = document
          .getElementById("visitors-chart")
          .getContext("2d");

        var myPieChart = new Chart(pieChart, {
          type: "pie",
          data: {
            datasets: [
              {
                data: [
                  "{{solidbooks}}",
                  "{{availablebooks}}",
                  "{{rentalbooks}}",
                ],
                backgroundColor: ["#27c100", "#f3545d", "#fdaf4b"],
                borderWidth: 10,
              },
            ],
            labels: ["Available", "Sold", "Rented"],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            legend: {
              position: "bottom",
              labels: {
                fontColor: "#000",
                fontSize: 15,
                usePointStyle: true,
                padding: 30,
              },
            },
            pieceLabel: {
              render: "percentage",
              fontColor: "white",
              fontSize: 14,
            },
          },
        });
      });
    </script>
  </body>
</html>
